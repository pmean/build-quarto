---
title: "My boxplot shows a box but no whiskers"
author: "Steve Simon"
date: '2022-12-15'
categories: 
- "*Blog post"
- 2022
- Graphical display
source: new
page_update: complete
execute: 
  fig-height: 1.5
  echo: false
---

```{r}
#| label: setup
#| message: false
#| warning: false

library(tidyverse)
```

One of my favorite graphs is the box plot. It is a visualization of a five number summary. Those five numbers are minimum, 25th percentile, median (aka the 50th percentile), 75th percentile, and maximum. The box in a box plot extends from the 25th to the 75th percentile and a line inside the box represents the median. Then you draw a whisker from the 25th percentile down to the minimum value and another whisker from the 75th percentile up to the maximum value. If there are extreme outliers, those points are highlighted individually.

Sometimes a boxplot might be missing one or both whiskers. Here's how that can happen.

Start with some artificial data.

```{r}
#| label: box-with-no-whiskers-01

gen_x <- function(n, a, b, trunc) {
  x <- c(rep(0,trunc), qbeta((1:n)/(n+1), a, b))
  x <- (x-min(x))/(max(x)-min(x))
  # x[1:(n*trunc)] <- 0
  
  x <- round(6*x, 1)
}

pseudo_boxplot <- function(x) {
  data.frame(x, g=" ") |>
    ggplot() +
    aes(g, x) +
    geom_boxplot() +
    xlab(" ") +
    coord_flip() 
}

a <- 1
b <- 5

x1 <- gen_x(n=9, a=a, b=b, trunc=1)
sort(x1)
```

Here is the boxplot.

```{r}
pseudo_boxplot(x1)
```

What happens if there are a lot more values at the minimum?

```{r}
#| label: box-with-no-whiskers-02

x2 <- gen_x(n=6, a=a, b=b, trunc=4)
sort(x2)
```

Here is what the boxplot looks like.

```{r}

pseudo_boxplot(x2)
```

What's going on here? There is a small difference between the minimum value and the 25th percentile in the first dataset.

```{r}
quantile(x1)
```

For the second data set, a large proportion of values are piled up at zero. This means that there is no difference between the minimum value and the 25th percentile. 

```{r}
quantile(x2)
```

The minimum and the 25th percentile are both zero in this dataset. So drawing a whisker from the 25th percentile down to the minimum value means drawing no whisker at all.

In general, a box with no whisker means that at least a quarter of the data is piled up at one extreme.

You can also get a boxplot with no whiskers on either end if the sample size is small (less than five). It may or may not happen depending on how your computer computes percentiles. There are at least a half dozen different ways to compute percentiles. The formulas don't differ much except for small sample sizes.

An [earlier version][sim2] of this page was published on [new.pmean.com][sim1].

[sim1]: http://new.pmean.com
[sim2]: http://new.pmean.com/box-with-no-whiskers/
